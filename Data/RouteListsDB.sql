CREATE DATABASE RouteListsDB
GO
USE RouteListsDB
GO

CREATE TABLE PassTypes(
	ID INT NOT NULL IDENTITY(1, 1),
	Title NVARCHAR(150) NOT NULL,

	PRIMARY KEY(ID)
)
GO

CREATE TABLE Vehicles(
	ID INT NOT NULL IDENTITY(1, 1),
	Brand NVARCHAR(150) NOT NULL,
	Number NVARCHAR(15) NOT NULL UNIQUE,
	Tonnage DECIMAL(10,2) NOT NULL,

	PRIMARY KEY(ID)
)
GO

CREATE TABLE VehiclePasses(
	ID INT NOT NULL,
	PassType INT NOT NULL,
	ExpireDate DATE NOT NULL,

	PRIMARY KEY(ID),
	FOREIGN KEY(ID) REFERENCES Vehicles(ID),
	FOREIGN KEY(PassType) REFERENCES PassTypes(ID)
)
GO

CREATE TABLE Drivers(
	ID INT NOT NULL IDENTITY(1, 1),
	Surname NVARCHAR(75) NOT NULL,
	Name NVARCHAR(75) NOT NULL,
	Patronymic NVARCHAR(75) NULL,
	Bithday DATE NOT NULL,
	DrivingExperience INT NOT NULL,
	MainVehicle INT NULL,

	PRIMARY KEY(ID),
	FOREIGN KEY(MainVehicle) REFERENCES Vehicles(ID)
)
GO

CREATE TABLE Companies(
	ID INT NOT NULL IDENTITY(1, 1),
	Title NVARCHAR(150) NOT NULL UNIQUE,

	PRIMARY KEY(ID)
)
GO

CREATE TABLE Managers(
	ID INT NOT NULL IDENTITY(1, 1),
	Company INT NOT NULL,
	Surname NVARCHAR(75) NULL,
	Name NVARCHAR(75) NULL,
	Pathronymic NVARCHAR(75) NULL,
	Phone NVARCHAR(20) UNIQUE,

	PRIMARY KEY(ID),
	FOREIGN KEY(Company) REFERENCES Companies(ID)
)
GO

CREATE TABLE RouteLists(
	ID NVARCHAR(25) NOT NULL,
	Driver INT NOT NULL,
	Vehicle INT NOT NULL,
	Date DATE NOT NULL,

	PRIMARY KEY(ID),
	FOREIGN KEY(Driver) REFERENCES Drivers(ID),
	FOREIGN KEY(Vehicle) REFERENCES Vehicles(ID)
)
GO

CREATE TABLE PointsAction(
	ID INT NOT NULL IDENTITY(1, 1),
	Action NVARCHAR(20) NOT NULL,

	PRIMARY KEY(ID)
)
GO

CREATE TABLE RoutePoints(
	ID NVARCHAR(25) NOT NULL,
	Address NVARCHAR(500) NOT NULL,
	Action INT NOT NULL,
	Manager INT NOT NULL,
	InvoiceNumbers NVARCHAR(150) NOT NULL,
	Cost DECIMAL(15,2) NULL,
	Comment NVARCHAR(500) NULL,

	PRIMARY KEY(ID),
	FOREIGN KEY(ID) REFERENCES RouteLists(ID),
	FOREIGN KEY(Manager) REFERENCES Managers(ID),
	FOREIGN KEY(Action) REFERENCES PointsAction(ID)
)
GO
